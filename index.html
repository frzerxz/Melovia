<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Melovia - Dijital Gitar SimÃ¼latÃ¶rÃ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg: #0c0c12;
            --panel: #13131a;
            --card: #1a1a24;
            --accent: #8b5cf6;
            --accent-dim: rgba(139, 92, 246, 0.3);
            --cyan: #06b6d4;
            --pink: #ec4899;
            --text: #e0e0e8;
            --dim: #707080;
            --muted: #404050;
            --border: rgba(255, 255, 255, 0.06);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            background: var(--panel);
            border-bottom: 1px solid var(--border);
            border-radius: 0 0 16px 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(90deg, #c084fc, #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .version {
            font-size: 9px;
            padding: 2px 6px;
            background: rgba(6, 182, 212, 0.25);
            border: 1px solid rgba(6, 182, 212, 0.4);
            color: #22d3ee;
            border-radius: 6px;
            font-weight: 600;
        }

        .nav {
            display: flex;
            gap: 6px;
        }

        .nav-btn {
            padding: 7px 16px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 16px;
            color: var(--dim);
            cursor: pointer;
            font-size: 12px;
        }

        .nav-btn.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .icon-btn {
            width: 30px;
            height: 30px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--dim);
            cursor: pointer;
        }

        .main {
            padding: 16px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Note Bar */
        .note-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 10px 16px;
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 12px;
            font-size: 12px;
        }

        .note-label {
            color: var(--muted);
        }

        .note-value {
            color: var(--cyan);
            font-weight: 500;
        }

        .note-divider {
            color: var(--border);
            margin: 0 10px;
        }

        /* Pair Row */
        .pair-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr) 180px;
            gap: 10px;
            margin-bottom: 12px;
        }

        .pair-card {
            padding: 14px;
            background: rgba(100, 100, 120, 0.08);
            border: 2px solid rgba(6, 182, 212, 0.4);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pair-card:hover {
            border-color: #06b6d4;
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
        }

        .pair-card.active {
            border-color: #06b6d4;
            background: rgba(6, 182, 212, 0.12);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.4);
        }

        .pair-title {
            font-weight: 600;
            font-size: 13px;
        }

        .pair-frets {
            font-size: 10px;
            color: var(--muted);
            margin: 4px 0 6px;
        }

        .pair-nums {
            display: flex;
            justify-content: center;
            gap: 4px;
        }

        .pair-nums span {
            width: 22px;
            height: 22px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
        }

        /* First number - Green - Soft but Vibrant */
        .pair-nums span:first-child {
            background: rgba(34, 197, 94, 0.15);
            border: 1px solid rgba(34, 197, 94, 0.4);
            color: #4ade80;
        }

        /* Second number - Pink - Soft but Vibrant */
        .pair-nums span:last-child {
            background: rgba(236, 72, 153, 0.15);
            border: 1px solid rgba(236, 72, 153, 0.4);
            color: #f472b6;
        }

        .ctrl-box {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 10px;
        }

        .ctrl-box h4 {
            font-size: 10px;
            color: var(--muted);
            margin-bottom: 8px;
            text-align: center;
        }

        .ctrl-btns {
            display: flex;
            gap: 6px;
        }

        .ctrl-btn {
            flex: 1;
            padding: 8px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text);
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }

        /* FRETBOARD */
        .fretboard-wrap {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .fretboard-toolbar {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            margin-bottom: 12px;
            font-size: 12px;
        }

        .fb-spacer {
            width: 40px;
        }

        /* Guitar Type Custom Dropdown */
        .guitar-dropdown {
            position: relative;
            display: inline-block;
        }

        .guitar-dropdown-btn {
            padding: 8px 20px;
            background: rgba(100, 100, 120, 0.12);
            border: 1px solid rgba(100, 100, 120, 0.25);
            border-radius: 20px;
            color: var(--dim);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .guitar-dropdown-btn:hover {
            background: rgba(100, 100, 120, 0.2);
            border-color: rgba(139, 92, 246, 0.3);
        }

        .guitar-dropdown-btn::after {
            content: 'â–¼';
            font-size: 8px;
            opacity: 0.6;
        }

        .guitar-dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 4px;
            background: rgba(30, 30, 40, 0.95);
            border: 1px solid rgba(100, 100, 120, 0.3);
            border-radius: 12px;
            overflow: hidden;
            min-width: 150px;
            display: none;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .guitar-dropdown.open .guitar-dropdown-menu {
            display: block;
        }

        .guitar-dropdown-item {
            padding: 10px 16px;
            color: var(--dim);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.15s;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
            display: block;
        }

        .guitar-dropdown-item:hover {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.25));
            color: var(--text);
        }

        .guitar-dropdown-item.active {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.3), rgba(168, 85, 247, 0.35));
            color: #c4b5fd;
        }

        .fb-label {
            color: var(--muted);
        }

        .fb-select {
            padding: 6px 10px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text);
            font-size: 11px;
        }

        .fb-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        /* Left arrow - Blue tones */
        .fb-btn:first-of-type {
            background: rgba(59, 130, 246, 0.25);
            border: 1px solid rgba(59, 130, 246, 0.4);
            color: #60a5fa;
        }

        /* Right arrow - Purple tones */
        .fb-btn.accent {
            background: rgba(168, 85, 247, 0.4);
            border: 1px solid rgba(168, 85, 247, 0.6);
            color: #c084fc;
            box-shadow: 0 0 10px rgba(168, 85, 247, 0.3);
        }

        .fb-btn:hover {
            transform: scale(1.08);
        }

        /* Range - Blue to Purple gradient */
        .fb-range {
            padding: 5px 16px;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.3), rgba(139, 92, 246, 0.4), rgba(168, 85, 247, 0.35));
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 6px;
            font-weight: 600;
            font-size: 11px;
            color: #c4b5fd;
        }

        .fretboard-container {
            display: flex;
            align-items: stretch;
        }

        .fretboard-gap {
            width: 8px;
        }

        .string-labels {
            display: flex;
            flex-direction: column;
            background: var(--panel);
            min-width: 32px;
            padding: 4px 6px;
            gap: 2px;
            border-radius: 8px;
        }

        .fretboard-nut {
            width: 6px;
            background: linear-gradient(180deg, #f5f5f0, #d8d4c8, #c0bdb0);
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }

        .fretboard {
            display: flex;
            flex: 1;
            min-height: 160px;
            background: linear-gradient(180deg, #1a0f05, #2a1808, #3a2510, #2a1808, #1a0f05);
            border-radius: 0 8px 8px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        }

        .string-label {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            color: var(--dim);
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 24px;
        }

        .string-label:hover {
            border-color: var(--accent);
        }

        .string-label.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 0 12px var(--accent);
        }

        .frets-row {
            display: flex;
            flex: 1;
        }

        .fret-col {
            flex: 1;
            min-width: 32px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Fret bars - extend slightly beyond strings but not to fretboard edge */
        .fret-col::after {
            content: '';
            position: absolute;
            right: 0;
            top: 4%;
            height: 92%;
            width: 2px;
            background: linear-gradient(180deg,
                    rgba(144, 136, 120, 0.3) 0%,
                    rgba(144, 136, 120, 0.85) 10%,
                    rgba(144, 136, 120, 0.9) 50%,
                    rgba(144, 136, 120, 0.85) 90%,
                    rgba(144, 136, 120, 0.3) 100%);
        }

        .string-cell {
            flex: 1;
            position: relative;
            cursor: pointer;
            min-height: 12px;
        }

        .string-cell::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
        }

        /* Thick wound strings (E6, A, D) - Bronze/Copper color */
        .string-cell[data-s="6"]::before {
            height: 2px;
            background: #b8860b;
        }

        .string-cell[data-s="5"]::before {
            height: 1.6px;
            background: #cd9b1d;
        }

        .string-cell[data-s="4"]::before {
            height: 1.3px;
            background: #daa520;
        }

        /* Plain steel strings (G, B, E1) - Silver/Steel color */
        .string-cell[data-s="3"]::before {
            height: 1px;
            background: #c0c0c0;
        }

        .string-cell[data-s="2"]::before {
            height: 0.8px;
            background: #d0d0d0;
        }

        .string-cell[data-s="1"]::before {
            height: 0.6px;
            background: #e0e0e0;
        }

        @keyframes vibrate {

            0%,
            100% {
                transform: translateY(-50%)
            }

            10% {
                transform: translateY(calc(-50% + 2px))
            }

            25% {
                transform: translateY(calc(-50% - 2px))
            }

            40% {
                transform: translateY(calc(-50% + 1.5px))
            }

            55% {
                transform: translateY(calc(-50% - 1.5px))
            }

            70% {
                transform: translateY(calc(-50% + 1px))
            }

            85% {
                transform: translateY(calc(-50% - 0.5px))
            }
        }

        .string-cell.vibrating::before {
            animation: vibrate 0.5s ease-out;
        }

        .note-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 24px;
            height: 20px;
            padding: 0 4px;
            border-radius: 10px;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: 600;
            background: var(--accent);
            color: white;
            z-index: 10;
        }

        .string-cell.active .note-dot {
            display: flex;
            animation: notePress 0.15s ease-out;
        }

        @keyframes notePress {
            0% {
                transform: translate(-50%, -50%) scale(0.9);
            }

            50% {
                transform: translate(-50%, -50%) scale(1.05);
            }

            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        /* Subtle glow when note is played - no crazy ripples */
        .string-cell.active::before {
            filter: brightness(1.8);
            transition: filter 0.1s ease-out;
        }

        .string-cell.active {
            background: rgba(139, 92, 246, 0.08);
        }

        /* Chord highlight */
        .string-cell.chord-highlight {
            background: rgba(139, 92, 246, 0.15);
        }

        .string-cell.chord-highlight .note-dot {
            display: flex;
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            box-shadow: 0 0 12px rgba(139, 92, 246, 0.6);
        }

        .inlay {
            position: absolute;
            left: 50%;
            background: radial-gradient(circle at 35% 35%, #fff, #e0e0d8, #c0c0b8);
            border-radius: 50%;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }

        .inlay.single {
            width: 7px;
            height: 7px;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        /* Double inlays: aligned with string 2 (top) and string 5 (bottom) */
        .inlay.double1 {
            width: 7px;
            height: 7px;
            top: 25%;
            transform: translate(-50%, -50%);
        }

        .inlay.double2 {
            width: 7px;
            height: 7px;
            top: 75%;
            transform: translate(-50%, -50%);
        }

        .fret-num {
            position: absolute;
            bottom: -18px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: var(--muted);
            display: none;
        }

        .fret-num.show {
            display: block;
        }

        .fret-num.hl {
            color: var(--pink);
        }

        /* Zone Grids - Side by Side */
        .zones-wrap {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .zone-panel {
            background: rgba(100, 100, 120, 0.08);
            border: 1px solid rgba(100, 100, 120, 0.2);
            border-radius: 12px;
            padding: 16px;
        }

        /* Zone 1 - Green left border */
        .zone-panel:first-child {
            border-left: 4px solid rgba(34, 197, 94, 0.5);
        }

        /* Zone 2 - Pink left border */
        .zone-panel:last-child {
            border-left: 4px solid rgba(236, 72, 153, 0.5);
        }

        .zone-head {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 14px;
        }

        .zone-tag {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 700;
        }

        /* Zone 1 tag - Green - Soft but Vibrant */
        .zone-tag.z1 {
            background: rgba(34, 197, 94, 0.15);
            border: 1px solid rgba(34, 197, 94, 0.4);
            color: #4ade80;
        }

        /* Zone 2 tag - Pink - Soft but Vibrant */
        .zone-tag.z2 {
            background: rgba(236, 72, 153, 0.15);
            border: 1px solid rgba(236, 72, 153, 0.4);
            color: #f472b6;
        }

        .zone-type {
            font-size: 11px;
            color: var(--muted);
        }

        /* Zone 1 type text - Green */
        .zone-panel:first-child .zone-type {
            color: rgba(74, 222, 128, 0.7);
        }

        /* Zone 2 type text - Pink */
        .zone-panel:last-child .zone-type {
            color: rgba(244, 114, 182, 0.7);
        }

        .key-grid {
            display: grid;
            grid-template-columns: 55px repeat(6, 40px);
            gap: 8px 10px;
            align-items: center;
            justify-items: center;
            justify-content: center;
        }

        .grid-label {
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            justify-self: stretch;
            text-align: right;
            color: var(--muted);
            padding-right: 5px;
            width: 100%;
        }

        .grid-header {
            font-size: 10px;
            font-weight: 600;
            text-align: center;
            padding: 4px 0;
            color: var(--dim);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .key-btn {
            width: 36px;
            height: 36px;
            background: var(--card);
            border: 2px solid var(--muted);
            border-radius: 8px;
            color: var(--text);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .key-btn:hover {
            transform: scale(1.03);
            box-shadow: 0 0 10px currentColor;
        }

        .key-btn.active {
            transform: scale(0.92);
        }

        /* String 1 (e) - Pink - Soft but Vibrant */
        .key-btn.s1 {
            background: rgba(236, 72, 153, 0.12);
            border-color: rgba(236, 72, 153, 0.35);
            color: #f472b6;
        }

        /* String 2 (B) - Orange - Soft but Vibrant */
        .key-btn.s2 {
            background: rgba(249, 115, 22, 0.12);
            border-color: rgba(249, 115, 22, 0.35);
            color: #fb923c;
        }

        /* String 3 (G) - Yellow - Soft but Vibrant */
        .key-btn.s3 {
            background: rgba(234, 179, 8, 0.12);
            border-color: rgba(234, 179, 8, 0.35);
            color: #facc15;
        }

        /* String 4 (D) - Green - Soft but Vibrant */
        .key-btn.s4 {
            background: rgba(34, 197, 94, 0.12);
            border-color: rgba(34, 197, 94, 0.35);
            color: #4ade80;
        }

        /* String 5 (A) - Cyan - Soft but Vibrant */
        .key-btn.s5 {
            background: rgba(6, 182, 212, 0.12);
            border-color: rgba(6, 182, 212, 0.35);
            color: #22d3ee;
        }

        /* String 6 (E) - Purple - Soft but Vibrant */
        .key-btn.s6 {
            background: rgba(139, 92, 246, 0.12);
            border-color: rgba(139, 92, 246, 0.35);
            color: #a78bfa;
        }

        .key-btn.s1.active {
            background: rgba(236, 72, 153, 0.5);
            color: white;
            box-shadow: 0 0 8px rgba(236, 72, 153, 0.4);
        }

        .key-btn.s2.active {
            background: rgba(249, 115, 22, 0.5);
            color: white;
            box-shadow: 0 0 8px rgba(249, 115, 22, 0.4);
        }

        .key-btn.s3.active {
            background: rgba(234, 179, 8, 0.5);
            color: #111;
            box-shadow: 0 0 8px rgba(234, 179, 8, 0.4);
        }

        .key-btn.s4.active {
            background: rgba(34, 197, 94, 0.5);
            color: white;
            box-shadow: 0 0 8px rgba(34, 197, 94, 0.4);
        }

        .key-btn.s5.active {
            background: rgba(6, 182, 212, 0.5);
            color: white;
            box-shadow: 0 0 8px rgba(6, 182, 212, 0.4);
        }

        .key-btn.s6.active {
            background: rgba(139, 92, 246, 0.5);
            color: white;
            box-shadow: 0 0 8px rgba(139, 92, 246, 0.4);
        }

        /* Zone 2 Grid - Different color scheme (warm tones) - Soft but Vibrant */
        #zone2Grid .key-btn.s1 {
            background: rgba(239, 68, 68, 0.12);
            border-color: rgba(239, 68, 68, 0.35);
            color: #fca5a5;
        }

        #zone2Grid .key-btn.s2 {
            background: rgba(245, 158, 11, 0.12);
            border-color: rgba(245, 158, 11, 0.35);
            color: #fcd34d;
        }

        #zone2Grid .key-btn.s3 {
            background: rgba(132, 204, 22, 0.12);
            border-color: rgba(132, 204, 22, 0.35);
            color: #bef264;
        }

        #zone2Grid .key-btn.s4 {
            background: rgba(20, 184, 166, 0.12);
            border-color: rgba(20, 184, 166, 0.35);
            color: #5eead4;
        }

        #zone2Grid .key-btn.s5 {
            background: rgba(99, 102, 241, 0.12);
            border-color: rgba(99, 102, 241, 0.35);
            color: #a5b4fc;
        }

        #zone2Grid .key-btn.s6 {
            background: rgba(236, 72, 153, 0.12);
            border-color: rgba(236, 72, 153, 0.35);
            color: #f472b6;
        }

        /* Piano */
        .piano-wrap {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 20px;
        }

        .piano-wrap h2 {
            font-size: 16px;
            margin-bottom: 14px;
        }

        .piano {
            display: flex;
            justify-content: center;
            background: #080808;
            border-radius: 8px;
            padding: 12px;
            height: 160px;
        }

        .white-key {
            width: 40px;
            height: 140px;
            background: linear-gradient(180deg, #f0f0f0, #d8d8d8);
            border: 1px solid #888;
            border-radius: 0 0 4px 4px;
            margin: 0 1px;
            cursor: pointer;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 6px;
            font-size: 9px;
            color: #666;
        }

        .white-key.active {
            background: #ccc;
        }

        .black-key {
            width: 26px;
            height: 90px;
            background: linear-gradient(180deg, #333, #111);
            border: 1px solid #000;
            border-radius: 0 0 3px 3px;
            margin-left: -14px;
            margin-right: -14px;
            z-index: 10;
            cursor: pointer;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 5px;
            font-size: 7px;
            color: #888;
        }

        .black-key.active {
            background: #444;
        }

        /* Lessons - Enhanced Design */
        .lessons-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .lessons-header h2 {
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .level-xp {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .level-badge {
            padding: 6px 14px;
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #a78bfa;
        }

        .xp-bar {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .xp-bar-bg {
            width: 150px;
            height: 8px;
            background: var(--card);
            border-radius: 4px;
            overflow: hidden;
        }

        .xp-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 4px;
            transition: width 0.3s;
        }

        .xp-text {
            font-size: 11px;
            color: var(--dim);
        }

        .lessons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .lesson-card {
            background: rgba(100, 100, 120, 0.08);
            border: 1px solid rgba(100, 100, 120, 0.2);
            border-radius: 14px;
            padding: 16px;
            transition: all 0.2s;
            position: relative;
        }

        .lesson-card:hover {
            border-color: rgba(139, 92, 246, 0.4);
            background: rgba(100, 100, 120, 0.12);
        }

        .lesson-card.locked {
            opacity: 0.6;
        }

        .lesson-card.locked .lesson-btn.primary {
            display: none;
        }

        .lesson-card.locked .lesson-btns::before {
            content: 'ðŸ”’ Kilitli';
            display: flex;
            flex: 1;
            padding: 10px 14px;
            background: rgba(100, 100, 120, 0.15);
            border: 1px solid rgba(100, 100, 120, 0.3);
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            color: var(--muted);
            align-items: center;
            justify-content: center;
        }

        .lesson-header {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 16px;
            min-height: 48px;
        }

        .lesson-icon {
            width: 48px;
            height: 48px;
            min-width: 48px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2));
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            position: absolute;
            left: 0;
            top: 0;
        }

        .lesson-info {
            width: 100%;
            text-align: center;
            padding: 0 40px;
            /* Ä°kon ve yÄ±ldÄ±z payÄ± */
        }

        .lesson-title-row {
            display: block;
            margin-bottom: 4px;
        }

        .lesson-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
        }

        .lesson-stars {
            color: #f59e0b;
            font-size: 11px;
            position: absolute;
            right: 0;
            top: 0;
            height: 48px;
            display: flex;
            align-items: center;
        }

        .lesson-artist {
            font-size: 11px;
            color: var(--dim);
            display: block;
        }

        .lesson-category {
            display: block;
            width: fit-content;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            margin: 0 auto 10px;
        }

        .lesson-category.melodi {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid rgba(34, 197, 94, 0.4);
            color: #4ade80;
        }

        .lesson-category.ritim {
            background: rgba(249, 115, 22, 0.2);
            border: 1px solid rgba(249, 115, 22, 0.4);
            color: #fb923c;
        }

        .lesson-category.teknik {
            background: rgba(236, 72, 153, 0.2);
            border: 1px solid rgba(236, 72, 153, 0.4);
            color: #f472b6;
        }

        .lesson-category.parmak {
            background: rgba(6, 182, 212, 0.2);
            border: 1px solid rgba(6, 182, 212, 0.4);
            color: #22d3ee;
        }

        .lesson-category.sarki {
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.4);
            color: #a78bfa;
        }

        .lesson-desc {
            font-size: 11px;
            color: var(--dim);
            margin-bottom: 10px;
            text-align: center;
        }

        .lesson-chords {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 12px;
            justify-content: center;
        }

        .chord-btn {
            padding: 4px 10px;
            background: rgba(100, 100, 120, 0.15);
            border: 1px solid rgba(100, 100, 120, 0.3);
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            color: var(--dim);
        }

        .lesson-btns {
            display: flex;
            gap: 8px;
        }

        .lesson-btn {
            flex: 1;
            padding: 10px 14px;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .lesson-btn.primary {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            color: white;
            box-shadow: 0 2px 10px rgba(139, 92, 246, 0.3);
        }

        .lesson-btn.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        .lesson-btn.secondary {
            background: rgba(100, 100, 120, 0.15);
            color: var(--dim);
            border: 1px solid rgba(100, 100, 120, 0.3);
        }

        .lesson-btn.secondary:hover {
            background: rgba(100, 100, 120, 0.25);
        }

        .lesson-btn.locked {
            background: rgba(100, 100, 120, 0.1);
            color: var(--muted);
            cursor: not-allowed;
        }

        @media (max-width: 900px) {
            .pair-row {
                grid-template-columns: 1fr 1fr;
            }

            .zones-wrap {
                grid-template-columns: 1fr;
            }

            .lessons-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Lesson HUD (Heads-Up Display) */
        .lesson-hud {
            display: none;
            /* BaÅŸlangÄ±Ã§ta gizli */
            background: #13131f;
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 20px;
            width: 100%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            margin-top: 10px;
        }

        .lesson-hud.active {
            display: block;
        }

        .hud-progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            margin-bottom: 12px;
            overflow: hidden;
        }

        .hud-progress-fill {
            height: 100%;
            background: #4ade80;
            width: 0%;
            transition: width 0.3s;
        }

        .hud-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            color: #fff;
        }

        .hud-song-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hud-song-icon {
            font-size: 18px;
        }

        .hud-song-title {
            font-weight: 600;
            font-size: 14px;
        }

        .hud-song-artist {
            color: var(--dim);
            font-size: 12px;
            margin-left: 6px;
        }

        .hud-step-counter {
            font-family: monospace;
            color: #4ade80;
            font-size: 16px;
            font-weight: bold;
        }

        /* Compact HUD Styles */
        .hud-compact-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(20, 20, 30, 0.4);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            padding: 8px 16px;
            margin-bottom: 0;
            gap: 12px;
        }

        .hud-left,
        .hud-right {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .no-shrink {
            flex-shrink: 0;
        }

        .hud-center-info {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
        }

        .hud-text-group {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
            text-align: left;
        }

        .note-badge-compact {
            font-size: 20px;
            font-weight: 800;
            color: #4ade80;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.4);
        }

        .hud-tech-details {
            display: flex;
            gap: 6px;
            font-size: 11px;
            color: var(--dim);
        }

        .hud-key-hint-compact {
            width: 28px;
            height: 28px;
            background: #8b5cf6;
            color: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }

        .hud-controls-inline {
            display: flex;
            gap: 6px;
        }

        .hud-btn-icon {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--dim);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s;
        }

        .hud-btn-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        .hud-btn-icon.close {
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.3);
            background: rgba(239, 68, 68, 0.1);
        }

        .hud-btn-icon.close:hover {
            background: rgba(239, 68, 68, 0.3);
            color: #fff;
        }

        .hud-timeline-wrap {
            position: relative;
            height: 60px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 0;
            margin-top: 10px;
        }

        .hud-target-line {
            position: absolute;
            left: 50%;
            top: 10%;
            bottom: 10%;
            width: 2px;
            background: #4ade80;
            transform: translateX(-50%);
            z-index: 10;
            box-shadow: 0 0 10px #4ade80;
        }

        .hud-timeline {
            display: flex;
            gap: 40px;
            /* GeniÅŸ boÅŸluk */
            position: absolute;
            left: 50%;
            transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1);
            /* transform ile kaydÄ±racaÄŸÄ±z */
        }

        .timeline-note {
            min-width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: var(--dim);
            opacity: 0.4;
            transform: scale(0.8);
            transition: all 0.3s;
        }

        .timeline-note.active {
            background: #4ade80;
            color: #000;
            border-color: #4ade80;
            font-weight: bold;
            transform: scale(1.3);
            opacity: 1;
            z-index: 5;
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.5);
        }

        .timeline-note.passed {
            background: rgba(74, 222, 128, 0.1);
            color: #4ade80;
            opacity: 0.2;
        }

        .hud-restart-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--dim);
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-right: 8px;
        }

        .hud-restart-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .hud-close-btn {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.4);
            width: 24px;
            height: 24px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .lessons-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Lesson Detail Modal */
        .lesson-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .lesson-modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--panel);
            border: 1px solid rgba(100, 100, 120, 0.3);
            border-radius: 16px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--dim);
            font-size: 24px;
            cursor: pointer;
        }

        .modal-section {
            margin-bottom: 18px;
        }

        .modal-section h4 {
            font-size: 12px;
            color: var(--dim);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .chord-diagram {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .chord-card {
            background: rgba(100, 100, 120, 0.1);
            border: 1px solid rgba(100, 100, 120, 0.2);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            min-width: 80px;
        }

        .chord-card .chord-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 4px;
        }

        .chord-card .chord-fingers {
            font-size: 10px;
            color: var(--dim);
        }

        .tip-box {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 10px;
            padding: 12px;
        }

        .tip-box p {
            font-size: 12px;
            color: var(--dim);
            line-height: 1.5;
        }

        .modal-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
        }

        /* ============================================
           EFFECTS PANEL - Floating Sidebar
           ============================================ */
        .effects-panel {
            position: fixed;
            top: 60px;
            right: -360px;
            width: 340px;
            max-height: calc(100vh - 80px);
            background: linear-gradient(180deg, rgba(19, 19, 26, 0.98), rgba(10, 10, 15, 0.98));
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px 0 0 16px;
            padding: 16px;
            z-index: 500;
            overflow-y: auto;
            transition: right 0.3s ease;
            box-shadow: -4px 0 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
        }

        .effects-panel.active {
            right: 0;
        }

        .effects-panel::-webkit-scrollbar {
            width: 6px;
        }

        .effects-panel::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 3px;
        }

        .fx-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .fx-title {
            font-size: 16px;
            font-weight: 700;
            background: linear-gradient(90deg, #8b5cf6, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .fx-close {
            width: 28px;
            height: 28px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--dim);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .fx-close:hover {
            background: rgba(236, 72, 153, 0.2);
            border-color: rgba(236, 72, 153, 0.4);
            color: #f472b6;
        }

        .fx-section {
            margin-bottom: 18px;
            padding: 14px;
            background: rgba(100, 100, 120, 0.06);
            border: 1px solid rgba(100, 100, 120, 0.15);
            border-radius: 12px;
        }

        .fx-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .fx-section-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--dim);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .fx-toggle {
            position: relative;
            width: 42px;
            height: 22px;
            background: rgba(100, 100, 120, 0.3);
            border-radius: 11px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .fx-toggle.active {
            background: linear-gradient(90deg, #8b5cf6, #a855f7);
        }

        .fx-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 18px;
            height: 18px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .fx-toggle.active::after {
            transform: translateX(20px);
        }

        /* Amp Preset Buttons */
        .amp-presets {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .amp-btn {
            padding: 10px 8px;
            background: rgba(100, 100, 120, 0.1);
            border: 2px solid rgba(100, 100, 120, 0.25);
            border-radius: 8px;
            color: var(--dim);
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .amp-btn:hover {
            border-color: rgba(139, 92, 246, 0.5);
            background: rgba(139, 92, 246, 0.1);
        }

        .amp-btn.active {
            border-color: #8b5cf6;
            background: rgba(139, 92, 246, 0.2);
            color: #c4b5fd;
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
        }

        .amp-btn .amp-icon {
            font-size: 18px;
            display: block;
            margin-bottom: 4px;
        }

        /* Sliders */
        .fx-slider-group {
            margin-bottom: 14px;
        }

        .fx-slider-group:last-child {
            margin-bottom: 0;
        }

        .fx-slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            font-size: 11px;
        }

        .fx-slider-label span:first-child {
            color: var(--dim);
        }

        .fx-slider-label span:last-child {
            color: var(--cyan);
            font-weight: 600;
        }

        .fx-slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(100, 100, 120, 0.3);
            border-radius: 3px;
            outline: none;
            cursor: pointer;
        }

        .fx-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(139, 92, 246, 0.4);
            transition: transform 0.1s;
        }

        .fx-slider::-webkit-slider-thumb:hover {
            transform: scale(1.15);
        }

        /* EQ Vertical Sliders */
        .eq-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            padding: 10px 0;
            height: 140px;
        }

        .eq-band {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .eq-band label {
            font-size: 10px;
            color: var(--dim);
            font-weight: 600;
        }

        .eq-band .eq-value {
            font-size: 11px;
            color: var(--cyan);
            font-weight: 600;
        }

        .eq-slider-vertical {
            writing-mode: bt-lr;
            -webkit-appearance: slider-vertical;
            appearance: slider-vertical;
            width: 6px;
            height: 80px;
            background: rgba(100, 100, 120, 0.3);
            border-radius: 3px;
        }

        /* Metronome */
        .metronome-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .metronome-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 2px solid var(--accent);
            background: rgba(139, 92, 246, 0.15);
            color: var(--accent);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .metronome-btn.playing {
            background: var(--accent);
            color: white;
            animation: metronomePulse 0.5s ease infinite;
        }

        @keyframes metronomePulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .metronome-bpm {
            flex: 1;
        }

        .bpm-display {
            font-size: 24px;
            font-weight: 700;
            color: var(--text);
            text-align: center;
        }

        .bpm-display small {
            font-size: 10px;
            color: var(--muted);
            margin-left: 4px;
        }

        /* Wave Animation for Active Effects */
        .fx-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            margin-left: 8px;
            animation: fxPulse 1s ease infinite;
        }

        @keyframes fxPulse {

            0%,
            100% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.5;
                transform: scale(0.8);
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="logo"><span>ðŸŽµ</span><span class="logo-text">Melovia</span><span class="version">v0.4</span></div>
        <nav class="nav">
            <button class="nav-btn active" onclick="showSection('guitar')">ðŸŽ¸ Gitar</button>
            <button class="nav-btn" onclick="showSection('piano')">ðŸŽ¹ Piyano</button>
            <button class="nav-btn" onclick="showSection('lessons')">ðŸ“š Dersler</button>
        </nav>
        <div class="header-right">
            <button class="icon-btn" onclick="toggleEffectsPanel()" title="Efektler">âš™</button>
            <button class="icon-btn" onclick="showHelp()">?</button>
        </div>
    </header>

    <main class="main">
        <section class="section active" id="guitar">
            <!-- Fretboard FIRST (EN ÃœSTTE) -->
            <div class="fretboard-wrap">
                <div class="fretboard-toolbar">
                    <div class="guitar-dropdown" id="guitarDropdown">
                        <button class="guitar-dropdown-btn" onclick="toggleGuitarDropdown()">
                            <span id="guitarTypeLabel">ðŸŽ¸ Klasik Gitar</span>
                        </button>
                        <div class="guitar-dropdown-menu">
                            <button class="guitar-dropdown-item active" data-type="classic"
                                onclick="selectGuitarType('classic', 'ðŸŽ¸ Klasik Gitar')">ðŸŽ¸ Klasik Gitar</button>
                            <button class="guitar-dropdown-item" data-type="electric"
                                onclick="selectGuitarType('electric', 'âš¡ Elektro Gitar')">âš¡ Elektro Gitar</button>
                            <button class="guitar-dropdown-item" data-type="bass"
                                onclick="selectGuitarType('bass', 'ðŸŽ¸ Bas Gitar')">ðŸŽ¸ Bas Gitar</button>
                        </div>
                    </div>
                    <div class="fb-spacer"></div>
                    <span class="fb-label">ï¿½ GÃ¶rÃ¼nÃ¼m:</span>
                    <span class="fb-label"> GÃ¶rÃ¼nÃ¼m:</span>
                    <button class="fb-btn" onclick="shiftFrets(-1)">â—€</button>
                    <span class="fb-range" id="fretRange">Perde 1-12</span>
                    <button class="fb-btn accent" onclick="shiftFrets(1)">â–¶</button>
                </div>

                <!-- Live Lesson HUD (Compact Design) -->
                <div class="lesson-hud" id="lessonHud">
                    <div class="hud-progress-bar">
                        <div class="hud-progress-fill" id="hudProgress" style="width: 0%"></div>
                    </div>

                    <div class="hud-compact-row">
                        <!-- SOL: ÅžarkÄ± Bilgisi -->
                        <div class="hud-left no-shrink">
                            <span class="hud-song-icon">ðŸŽµ</span>
                            <div class="hud-text-group">
                                <span class="hud-song-title" id="hudTitle">...</span>
                                <span class="hud-song-artist" id="hudArtist">...</span>
                            </div>
                        </div>

                        <!-- ORTA: Aktif Nota ve Ä°puÃ§larÄ± -->
                        <div class="hud-center-info">
                            <span class="note-badge-compact" id="hudCurrentNote">-</span>
                            <div class="hud-tech-details">
                                <span class="detail-tag" id="hudStringInfo">Tel -</span>
                                <span class="detail-tag" id="hudFretInfo">Perde -</span>
                            </div>
                            <div class="hud-key-hint-compact" id="hudKeyHint">?</div>
                        </div>

                        <!-- SAÄž: SayaÃ§ ve Kontroller -->
                        <div class="hud-right no-shrink">
                            <div class="hud-step-counter" id="hudCounter">0 / 0</div>
                            <div class="hud-controls-inline">
                                <button class="hud-btn-icon" onclick="startLesson()" title="BaÅŸtan BaÅŸlat">â†º</button>
                                <button class="hud-btn-icon close" onclick="stopLesson()" title="Dersi Bitir">âœ•</button>
                            </div>
                        </div>
                    </div>

                    <div class="hud-timeline-wrap">
                        <div class="hud-target-line"></div>
                        <div class="hud-timeline" id="hudTimeline">
                            <!-- Timeline items will be injected here -->
                        </div>
                    </div>
                </div>
                <div class="fretboard-container">
                    <div class="string-labels" id="stringLabels"></div>
                    <div class="fretboard-gap"></div>
                    <div class="fretboard-nut"></div>
                    <div class="fretboard" id="fretboard"></div>
                </div>
            </div>

            <!-- Note Bar -->
            <div class="note-bar">
                <span class="note-label">Nota:</span>
                <span class="note-value" id="noteDisplay">Mi (E2) - 82.4 Hz</span>
                <span class="note-divider">|</span>
                <span class="note-label">Pozisyon:</span>
                <span class="note-value" id="posDisplay">Tel 6, Perde 0</span>
            </div>

            <!-- Pair Row SECOND -->
            <div class="pair-row">
                <div class="pair-card active" data-pair="1" onclick="setPair(1)">
                    <div class="pair-title">Pair 1</div>
                    <div class="pair-frets">0 - 7. Perde</div>
                    <div class="pair-nums"><span>1</span><span>2</span></div>
                </div>
                <div class="pair-card" data-pair="2" onclick="setPair(2)">
                    <div class="pair-title">Pair 2</div>
                    <div class="pair-frets">8 - 15. Perde</div>
                    <div class="pair-nums"><span>3</span><span>4</span></div>
                </div>
                <div class="pair-card" data-pair="3" onclick="setPair(3)">
                    <div class="pair-title">Pair 3</div>
                    <div class="pair-frets">16 - 19. Perde</div>
                    <div class="pair-nums"><span>5</span><span>6</span></div>
                </div>
                <div class="ctrl-box">
                    <h4>ðŸŽ›ï¸ Kontroller</h4>
                    <div class="ctrl-btns">
                        <button class="ctrl-btn" onclick="setPair(Math.min(3, currentPair + 1))">+</button>
                        <button class="ctrl-btn" onclick="setPair(Math.max(1, currentPair - 1))">-</button>
                        <button class="ctrl-btn" onclick="stopAll()">MUTE</button>
                    </div>
                </div>
            </div>

            <!-- Zone Grids Side by Side -->
            <div class="zones-wrap">
                <div class="zone-panel">
                    <div class="zone-head">
                        <span class="zone-tag z1" id="zone1Tag">Zone 1 (0-3)</span>
                        <span class="zone-type">ðŸŽ¸ Primary Grid</span>
                    </div>
                    <div class="key-grid" id="zone1Grid"></div>
                </div>
                <div class="zone-panel">
                    <div class="zone-head">
                        <span class="zone-tag z2" id="zone2Tag">Zone 2 (4-7)</span>
                        <span class="zone-type">ðŸŽ¹ Vertical Cluster</span>
                    </div>
                    <div class="key-grid" id="zone2Grid"></div>
                </div>
            </div>
        </section>

        <section class="section" id="piano">
            <div class="piano-wrap">
                <h2>ðŸŽ¹ Piyano Modu</h2>
                <div class="piano" id="pianoKeys"></div>
            </div>
        </section>

        <section class="section" id="lessons">
            <div class="lessons-header">
                <h2>ðŸŽ¸ Gitar Dersleri</h2>
                <div class="level-xp">
                    <span class="level-badge">Seviye 1: BaÅŸlangÄ±Ã§</span>
                    <div class="xp-bar">
                        <div class="xp-bar-bg">
                            <div class="xp-bar-fill" style="width: 34%"></div>
                        </div>
                        <span class="xp-text">850 / 2500 XP</span>
                    </div>
                </div>
            </div>
            <div class="lessons-grid">
                <!-- Ders 1: BaÅŸlangÄ±Ã§ - Ã‡ok Kolay -->
                <div class="lesson-card">
                    <div class="lesson-header">
                        <div class="lesson-icon">ðŸŽµ</div>
                        <div class="lesson-info">
                            <div class="lesson-title-row">
                                <span class="lesson-title">Ders 1: Ä°lk Melodim</span>
                                <span class="lesson-stars">â˜…â˜†â˜†</span>
                            </div>
                            <span class="lesson-artist">ArkadaÅŸÄ±m EÅŸek - BarÄ±ÅŸ ManÃ§o</span>
                        </div>
                    </div>
                    <span class="lesson-category melodi">Melodi Ã‡alÄ±ÅŸmasÄ±</span>
                    <p class="lesson-desc">Orijinal ton Em. Basit nota diziliÅŸi ile gitar Ã§almaya ilk adÄ±m. Tek parmak
                        melodi pratiÄŸi.</p>
                    <div class="lesson-chords">
                        <span class="chord-btn">Em</span>
                        <span class="chord-btn">Am</span>
                    </div>
                    <div class="lesson-btns">
                        <button class="lesson-btn primary" onclick="startLesson()">â–¶ Dersi BaÅŸlat</button>
                        <button class="lesson-btn secondary" onclick="showLessonDetail(1)">ðŸ“„ Detay</button>
                    </div>
                </div>

                <!-- Ders 2: Temel Akorlar - Kolay -->
                <div class="lesson-card">
                    <div class="lesson-header">
                        <div class="lesson-icon">ðŸŽ¸</div>
                        <div class="lesson-info">
                            <div class="lesson-title-row">
                                <span class="lesson-title">Ders 2: Temel Akorlar</span>
                                <span class="lesson-stars">â˜…â˜…â˜†</span>
                            </div>
                            <span class="lesson-artist">Hayat Bayram Olsa - Åženay</span>
                        </div>
                    </div>
                    <span class="lesson-category ritim">Ritim Ã‡alÄ±ÅŸmasÄ±</span>
                    <p class="lesson-desc">Am ve E akorlarÄ±nÄ± Ã¶ÄŸren. 4/4 ritim kalÄ±bÄ± ile basit akor geÃ§iÅŸleri. Dm
                        akoruna giriÅŸ.</p>
                    <div class="lesson-chords">
                        <span class="chord-btn">Am</span>
                        <span class="chord-btn">E</span>
                        <span class="chord-btn">Dm</span>
                    </div>
                    <div class="lesson-btns">
                        <button class="lesson-btn primary" onclick="startLesson()">â–¶ Dersi BaÅŸlat</button>
                        <button class="lesson-btn secondary" onclick="showLessonDetail(2)">ðŸ“„ Detay</button>
                    </div>
                </div>

                <!-- Ders 3: Palm Mute - Orta -->
                <div class="lesson-card locked">
                    <div class="lesson-header">
                        <div class="lesson-icon">ðŸ–ï¸</div>
                        <div class="lesson-info">
                            <div class="lesson-title-row">
                                <span class="lesson-title">Ders 3: Palm Mute</span>
                                <span class="lesson-stars">â˜…â˜…â˜†</span>
                            </div>
                            <span class="lesson-artist">Kesme Ritim TekniÄŸi</span>
                        </div>
                    </div>
                    <span class="lesson-category teknik">Teknik AlÄ±ÅŸtÄ±rma</span>
                    <p class="lesson-desc">SaÄŸ el avuÃ§ iÃ§i ile tel susturma. KÃ¶prÃ¼ye yakÄ±n pozisyon. Rock ve metal
                        ritmlerinde kullanÄ±lÄ±r.</p>
                    <div class="lesson-chords">
                        <span class="chord-btn">E5</span>
                        <span class="chord-btn">A5</span>
                        <span class="chord-btn">D5</span>
                    </div>
                    <div class="lesson-btns">
                        <button class="lesson-btn primary" onclick="startLesson()">â–¶ Dersi BaÅŸlat</button>
                        <button class="lesson-btn secondary" onclick="showLessonDetail(3)">ðŸ“„ Detay</button>
                    </div>
                </div>

                <!-- Ders 4: Arpej P-I-M-A - Orta-Zor -->
                <div class="lesson-card locked">
                    <div class="lesson-header">
                        <div class="lesson-icon">ðŸŽ¶</div>
                        <div class="lesson-info">
                            <div class="lesson-title-row">
                                <span class="lesson-title">Ders 4: Arpej TekniÄŸi</span>
                                <span class="lesson-stars">â˜…â˜…â˜…</span>
                            </div>
                            <span class="lesson-artist">Caddelerde RÃ¼zgar - NilÃ¼fer</span>
                        </div>
                    </div>
                    <span class="lesson-category parmak">Parmak Ã‡alÄ±ÅŸmasÄ±</span>
                    <p class="lesson-desc">P-I-M-A kuralÄ±: BaÅŸparmak (6-5-4), Ä°ÅŸaret (3), Orta (2), YÃ¼zÃ¼k (1). Klasik
                        gitar tekniÄŸi.</p>
                    <div class="lesson-chords">
                        <span class="chord-btn">Am</span>
                        <span class="chord-btn">Dm</span>
                        <span class="chord-btn">E</span>
                    </div>
                    <div class="lesson-btns">
                        <button class="lesson-btn primary" onclick="startLesson()">â–¶ Dersi BaÅŸlat</button>
                        <button class="lesson-btn secondary" onclick="showLessonDetail(4)">ðŸ“„ Detay</button>
                    </div>
                </div>

                <!-- Ders 5: Akor GeÃ§iÅŸleri - Zor -->
                <div class="lesson-card locked">
                    <div class="lesson-header">
                        <div class="lesson-icon">ðŸŽ¤</div>
                        <div class="lesson-info">
                            <div class="lesson-title-row">
                                <span class="lesson-title">Ders 5: HÄ±zlÄ± GeÃ§iÅŸler</span>
                                <span class="lesson-stars">â˜…â˜…â˜…</span>
                            </div>
                            <span class="lesson-artist">Akdeniz AkÅŸamlarÄ± - Haluk Levent</span>
                        </div>
                    </div>
                    <span class="lesson-category sarki">Klasik TÃ¼rk ÅžarkÄ±sÄ±</span>
                    <p class="lesson-desc">4 akor dÃ¶ngÃ¼sÃ¼: Amâ†’Gâ†’Fâ†’E. Barre akor F iÃ§in parmak gÃ¼cÃ¼ gerektirir. HÄ±zlÄ±
                        geÃ§iÅŸ pratiÄŸi.</p>
                    <div class="lesson-chords">
                        <span class="chord-btn">Am</span>
                        <span class="chord-btn">G</span>
                        <span class="chord-btn">F</span>
                        <span class="chord-btn">E</span>
                    </div>
                    <div class="lesson-btns">
                        <button class="lesson-btn primary" onclick="startLesson()">â–¶ Dersi BaÅŸlat</button>
                        <button class="lesson-btn secondary" onclick="showLessonDetail(5)">ðŸ“„ Detay</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Lesson Detail Modal -->
    <div class="lesson-modal" id="lessonModal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h3 class="modal-title" id="modalTitle">Ders DetayÄ±</h3>
                    <p style="color: var(--dim); font-size: 12px;" id="modalArtist"></p>
                </div>
                <button class="modal-close" onclick="closeLessonModal()">âœ•</button>
            </div>

            <div class="modal-section">
                <h4>ðŸ“ AÃ§Ä±klama</h4>
                <p style="color: var(--text); font-size: 13px;" id="modalDesc"></p>
            </div>

            <div class="modal-section">
                <h4>ðŸŽ¸ Gerekli Akorlar</h4>
                <div class="chord-diagram" id="modalChords"></div>
            </div>

            <div class="modal-section">
                <h4>ðŸ’¡ Ä°puÃ§larÄ±</h4>
                <div class="tip-box">
                    <p id="modalTips"></p>
                </div>
            </div>

            <button class="modal-btn" onclick="startLesson()">â–¶ Dersi BaÅŸlat</button>
        </div>
    </div>

    <!-- Effects Control Panel -->
    <div class="effects-panel" id="effectsPanel">
        <div class="fx-header">
            <span class="fx-title">ðŸŽ›ï¸ Efekt KontrolÃ¼</span>
            <button class="fx-close" onclick="toggleEffectsPanel()">âœ•</button>
        </div>

        <!-- Amp Presets -->
        <div class="fx-section">
            <div class="fx-section-header">
                <span class="fx-section-title">ðŸŽ¸ AmplifikatÃ¶r</span>
            </div>
            <div class="amp-presets" id="ampPresets">
                <button class="amp-btn active" data-preset="clean" onclick="setAmpPreset('clean')">
                    <span class="amp-icon">ðŸŽµ</span>Clean
                </button>
                <button class="amp-btn" data-preset="crunch" onclick="setAmpPreset('crunch')">
                    <span class="amp-icon">ðŸ”¥</span>Crunch
                </button>
                <button class="amp-btn" data-preset="highgain" onclick="setAmpPreset('highgain')">
                    <span class="amp-icon">âš¡</span>High Gain
                </button>
                <button class="amp-btn" data-preset="acoustic" onclick="setAmpPreset('acoustic')">
                    <span class="amp-icon">ðŸª•</span>Acoustic
                </button>
                <button class="amp-btn" data-preset="jazz" onclick="setAmpPreset('jazz')">
                    <span class="amp-icon">ðŸŽ·</span>Jazz
                </button>
                <button class="amp-btn" data-preset="metal" onclick="setAmpPreset('metal')">
                    <span class="amp-icon">ðŸ¤˜</span>Metal
                </button>
            </div>
        </div>

        <!-- Master Volume & Reverb -->
        <div class="fx-section">
            <div class="fx-section-header">
                <span class="fx-section-title">ðŸ”Š Master</span>
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Volume</span>
                    <span id="volumeValue">75%</span>
                </div>
                <input type="range" class="fx-slider" id="masterVolume" min="0" max="100" value="75"
                    oninput="updateVolume(this.value)">
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Reverb</span>
                    <span id="reverbValue">15%</span>
                </div>
                <input type="range" class="fx-slider" id="reverbMix" min="0" max="100" value="15"
                    oninput="updateReverb(this.value)">
            </div>
        </div>

        <!-- Chorus -->
        <div class="fx-section">
            <div class="fx-section-header">
                <span class="fx-section-title">ðŸ’« Chorus</span>
                <div class="fx-toggle" id="chorusToggle" onclick="toggleChorus()"></div>
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Rate</span>
                    <span id="chorusRateValue">1.5 Hz</span>
                </div>
                <input type="range" class="fx-slider" id="chorusRate" min="0.1" max="5" step="0.1" value="1.5"
                    oninput="updateChorusRate(this.value)">
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Depth</span>
                    <span id="chorusDepthValue">20%</span>
                </div>
                <input type="range" class="fx-slider" id="chorusDepth" min="0" max="100" value="20"
                    oninput="updateChorusDepth(this.value)">
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Mix</span>
                    <span id="chorusMixValue">30%</span>
                </div>
                <input type="range" class="fx-slider" id="chorusMix" min="0" max="100" value="30"
                    oninput="updateChorusMix(this.value)">
            </div>
        </div>

        <!-- Delay -->
        <div class="fx-section">
            <div class="fx-section-header">
                <span class="fx-section-title">ðŸ” Delay</span>
                <div class="fx-toggle" id="delayToggle" onclick="toggleDelay()"></div>
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Time</span>
                    <span id="delayTimeValue">350 ms</span>
                </div>
                <input type="range" class="fx-slider" id="delayTime" min="50" max="1000" value="350"
                    oninput="updateDelayTime(this.value)">
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Feedback</span>
                    <span id="delayFeedbackValue">30%</span>
                </div>
                <input type="range" class="fx-slider" id="delayFeedback" min="0" max="90" value="30"
                    oninput="updateDelayFeedback(this.value)">
            </div>
            <div class="fx-slider-group">
                <div class="fx-slider-label">
                    <span>Mix</span>
                    <span id="delayMixValue">25%</span>
                </div>
                <input type="range" class="fx-slider" id="delayMix" min="0" max="100" value="25"
                    oninput="updateDelayMix(this.value)">
            </div>
        </div>

        <!-- 3-Band EQ -->
        <div class="fx-section">
            <div class="fx-section-header">
                <span class="fx-section-title">ðŸ“Š Equalizer</span>
            </div>
            <div class="eq-container">
                <div class="eq-band">
                    <label>Low</label>
                    <input type="range" class="fx-slider" style="width: 60px;" id="eqLow" min="-12" max="12" value="0"
                        oninput="updateEQ()">
                    <span class="eq-value" id="eqLowValue">0 dB</span>
                </div>
                <div class="eq-band">
                    <label>Mid</label>
                    <input type="range" class="fx-slider" style="width: 60px;" id="eqMid" min="-12" max="12" value="0"
                        oninput="updateEQ()">
                    <span class="eq-value" id="eqMidValue">0 dB</span>
                </div>
                <div class="eq-band">
                    <label>High</label>
                    <input type="range" class="fx-slider" style="width: 60px;" id="eqHigh" min="-12" max="12" value="0"
                        oninput="updateEQ()">
                    <span class="eq-value" id="eqHighValue">0 dB</span>
                </div>
            </div>
        </div>

        <!-- Metronome -->
        <div class="fx-section">
            <div class="fx-section-header">
                <span class="fx-section-title">ðŸ¥ Metronom</span>
            </div>
            <div class="metronome-row">
                <button class="metronome-btn" id="metronomeBtn" onclick="toggleMetronome()">â–¶</button>
                <div class="metronome-bpm">
                    <div class="bpm-display">
                        <span id="bpmValue">120</span><small>BPM</small>
                    </div>
                    <input type="range" class="fx-slider" id="bpmSlider" min="40" max="220" value="120"
                        oninput="updateBPM(this.value)">
                </div>
            </div>
        </div>
    </div>

    <script src="js/noteMapping.js"></script>
    <script src="js/audioEngine.js"></script>
    <script>
        let currentPair = 1;
        let currentMode = 'guitar';
        let fretStart = 1;
        const visibleFrets = 12;
        const maxFrets = 19;
        const tuning = ['E4', 'B3', 'G3', 'D3', 'A2', 'E2'];
        const stringLabels = ['E', 'A', 'D', 'G', 'B', 'E'];
        const inlays = [3, 5, 7, 9, 12, 15, 17, 19];
        const doubleInlay = [12];

        // Zone 1,3,5 keys (Pair odd parts)
        const oddZoneKeys = [
            ['1', '2', '3', '4', '5', '6'],
            ['Q', 'W', 'E', 'R', 'T', 'Y'],
            ['A', 'S', 'D', 'F', 'G', 'H'],
            ['<', 'Z', 'X', 'C', 'V', 'B']
        ];

        // Zone 2,4,6 keys (Pair even parts)
        // Turkish keyboard: I key gives 'Ä±', Ä° key gives 'i'
        const evenZoneKeys = [
            ['7', '8', '9', '0', '*', '-'],
            ['U', 'I', 'O', 'P', 'Äž', 'Ãœ'],   // I = string 2
            ['J', 'K', 'L', 'Åž', 'Ä°', ','],   // Ä° = string 5
            ['N', 'M', 'Ã–', 'Ã‡', '.', '"']    // " = string 6
        ];

        // Turkish character mapping for keyboard input
        const turkishKeyMap = {
            'Ä±': 'I',  // lowercase Ä± -> uppercase I (dotless)
            'i': 'Ä°',  // lowercase i -> uppercase Ä° (dotted)
            'ÄŸ': 'Äž',
            'Ã¼': 'Ãœ',
            'ÅŸ': 'Åž',
            'Ã¶': 'Ã–',
            'Ã§': 'Ã‡'
        };

        // Guitar type configurations
        const guitarTypes = {
            classic: { name: 'Klasik Gitar', frets: 19, strings: 6 },
            electric: { name: 'Elektro Gitar', frets: 24, strings: 6 },
            bass: { name: 'Bas Gitar', frets: 24, strings: 4 }
        };

        let currentGuitarType = 'classic';
        let currentLessonId = null;

        // Ders verileri (araÅŸtÄ±rmaya dayalÄ±)
        const lessonsData = {
            1: {
                title: 'Ders 1: Ä°lk Melodim',
                artist: 'ArkadaÅŸÄ±m EÅŸek - BarÄ±ÅŸ ManÃ§o',
                desc: 'Bu ders, gitar Ã§almaya ilk adÄ±mÄ±nÄ±zÄ± atmanÄ±zÄ± saÄŸlar. BarÄ±ÅŸ ManÃ§o\'nun sevilen Ã§ocuk ÅŸarkÄ±sÄ± "ArkadaÅŸÄ±m EÅŸek" orijinal tonunda Em (Mi minÃ¶r) Ã§alÄ±nÄ±r.',
                chords: [
                    { name: 'Em', fingers: 'x-2-2-0-0-0' },
                    { name: 'Am', fingers: 'x-0-2-2-1-0' }
                ],
                tips: 'BaÅŸlangÄ±Ã§ iÃ§in yavaÅŸ tempo ile Ã§alÄ±ÅŸÄ±n. Ã–nce melodiyi ezberleyin.',
                songData: [
                    // PART 1: The Hook
                    { note: 'RE (D3)', s: 4, f: 0, key: '3' }, { note: 'RE (D3)', s: 4, f: 0, key: '3' },
                    { note: 'LA (A3)', s: 3, f: 2, key: 'F' }, { note: 'LA (A3)', s: 3, f: 2, key: 'F' },
                    { note: 'SÄ° (B3)', s: 2, f: 0, key: '5' }, { note: 'SÄ° (B3)', s: 2, f: 0, key: '5' },
                    { note: 'LA (A3)', s: 3, f: 2, key: 'F' },
                    // PART 2: The Verse
                    { note: 'SOL (G3)', s: 3, f: 0, key: '4' }, { note: 'SOL (G3)', s: 3, f: 0, key: '4' },
                    { note: 'SÄ° (B3)', s: 2, f: 0, key: '5' }, { note: 'SÄ° (B3)', s: 2, f: 0, key: '5' },
                    { note: 'LA (A3)', s: 3, f: 2, key: 'F' },
                    { note: 'SOL (G3)', s: 3, f: 0, key: '4' }, { note: 'SOL (G3)', s: 3, f: 0, key: '4' },
                    { note: 'SÄ° (B3)', s: 2, f: 0, key: '5' }, { note: 'SÄ° (B3)', s: 2, f: 0, key: '5' },
                    // PART 3: The Descent
                    { note: 'LA (A3)', s: 3, f: 2, key: 'F' }, { note: 'SOL (G3)', s: 3, f: 0, key: '4' },
                    { note: 'FA (F3)', s: 4, f: 3, key: 'C' },
                    { note: 'MÄ° (E3)', s: 4, f: 2, key: 'D' }, { note: 'MÄ° (E3)', s: 4, f: 2, key: 'D' },
                    { note: 'FA (F3)', s: 4, f: 3, key: 'C' }, { note: 'MÄ° (E3)', s: 4, f: 2, key: 'D' },
                    { note: 'RE (D3)', s: 4, f: 0, key: '3' },
                    // PART 4: Outro Loop x3 + Finale (4. ve 5. Teller - KalÄ±n Ton)
                    // Cycle 1
                    { note: 'RE (D3)', s: 4, f: 0, key: '3' }, { note: 'MÄ° (E3)', s: 4, f: 2, key: 'D' },
                    { note: 'FA (F3)', s: 4, f: 3, key: 'C' }, { note: 'RE (D3)', s: 4, f: 0, key: '3' },
                    { note: 'DO (C3)', s: 5, f: 3, key: 'X' },
                    // Cycle 2
                    { note: 'RE (D3)', s: 4, f: 0, key: '3' }, { note: 'MÄ° (E3)', s: 4, f: 2, key: 'D' },
                    { note: 'FA (F3)', s: 4, f: 3, key: 'C' }, { note: 'RE (D3)', s: 4, f: 0, key: '3' },
                    { note: 'DO (C3)', s: 5, f: 3, key: 'X' },
                    // Cycle 3
                    { note: 'RE (D3)', s: 4, f: 0, key: '3' }, { note: 'MÄ° (E3)', s: 4, f: 2, key: 'D' },
                    { note: 'FA (F3)', s: 4, f: 3, key: 'C' }, { note: 'RE (D3)', s: 4, f: 0, key: '3' },
                    { note: 'DO (C3)', s: 5, f: 3, key: 'X' },
                    // Grand Finale
                    { note: 'RE (D3)', s: 4, f: 0, key: '3' }
                ]
            },
            2: {
                title: 'Ders 2: Temel Akorlar',
                artist: 'Hayat Bayram Olsa - Åženay',
                desc: 'Am ve E akorlarÄ±nÄ± Ã¶ÄŸrenin. Åženay\'Ä±n nostaljik parÃ§asÄ± ile 4/4 ritim kalÄ±bÄ±nda basit akor geÃ§iÅŸleri yapacaksÄ±nÄ±z. Dm akoru ile Ã¼Ã§lÃ¼ akor progresyonuna giriÅŸ.',
                chords: [
                    { name: 'Am', fingers: 'x-0-2-2-1-0' },
                    { name: 'E', fingers: '0-2-2-1-0-0' },
                    { name: 'Dm', fingers: 'x-x-0-2-3-1' }
                ],
                tips: 'Akor geÃ§iÅŸlerinde parmaklarÄ± kaldÄ±rmadan kaydÄ±rÄ±n. Amâ†’E geÃ§iÅŸi en kolay geÃ§iÅŸlerden biridir. Her gÃ¼n 10 dakika pratik yapÄ±n.'
            },
            3: {
                title: 'Ders 3: Palm Mute',
                artist: 'Kesme Ritim TekniÄŸi',
                desc: 'Palm mute, saÄŸ el avuÃ§ iÃ§inin kenarÄ±nÄ± gitarÄ±n kÃ¶prÃ¼sÃ¼ne hafifÃ§e yerleÅŸtirerek telleri susturma tekniÄŸidir. Rock ve metal mÃ¼zikte "chug" sesi elde etmek iÃ§in kullanÄ±lÄ±r.',
                chords: [
                    { name: 'E5', fingers: '0-2-2-x-x-x' },
                    { name: 'A5', fingers: 'x-0-2-2-x-x' },
                    { name: 'D5', fingers: 'x-x-0-2-3-x' }
                ],
                tips: 'KÃ¶prÃ¼ye yakÄ±n pozisyonda daha net, uzaktayken daha boÄŸuk ses Ã§Ä±kar. BasÄ±ncÄ± ayarlamak iÃ§in pratik gerekir. Power chord\'lar ile baÅŸlayÄ±n.'
            },
            4: {
                title: 'Ders 4: Arpej TekniÄŸi',
                artist: 'Caddelerde RÃ¼zgar - NilÃ¼fer',
                desc: 'P-I-M-A klasik gitar tekniÄŸi: BaÅŸparmak (P) kalÄ±n telleri, Ä°ÅŸaret (I) 3. teli, Orta (M) 2. teli, YÃ¼zÃ¼k (A) 1. teli Ã§alar. Arpej, akor notalarÄ±nÄ± sÄ±rayla Ã§almaktÄ±r.',
                chords: [
                    { name: 'Am', fingers: 'x-0-2-2-1-0' },
                    { name: 'Dm', fingers: 'x-x-0-2-3-1' },
                    { name: 'E', fingers: '0-2-2-1-0-0' }
                ],
                tips: 'SaÄŸ el tenis topu tutar gibi olmalÄ±. BoÅŸ tellerden baÅŸlayÄ±n. P-Ä°-M-A, P-Ä°-M-A-M-Ä° kalÄ±plarÄ±nÄ± Ã§alÄ±ÅŸÄ±n. Metronom ile tempo artÄ±rÄ±n.'
            },
            5: {
                title: 'Ders 5: HÄ±zlÄ± GeÃ§iÅŸler',
                artist: 'Akdeniz AkÅŸamlarÄ± - Haluk Levent',
                desc: 'Haluk Levent\'in klasik parÃ§asÄ± Amâ†’Gâ†’Fâ†’E akor dÃ¶ngÃ¼sÃ¼nÃ¼ kullanÄ±r. F akoru barre (bareli) akor olduÄŸu iÃ§in parmak gÃ¼cÃ¼ gerektirir. HÄ±zlÄ± geÃ§iÅŸ pratiÄŸi iÃ§in idealdir.',
                chords: [
                    { name: 'Am', fingers: 'x-0-2-2-1-0' },
                    { name: 'G', fingers: '3-2-0-0-0-3' },
                    { name: 'F', fingers: '1-3-3-2-1-1' },
                    { name: 'E', fingers: '0-2-2-1-0-0' }
                ],
                tips: 'F akoru iÃ§in iÅŸaret parmaÄŸÄ±nÄ±zla tÃ¼m tellere basÄ±n (barre). Ã–nce yavaÅŸ Ã§alÄ±ÅŸÄ±n, sonra hÄ±zlanÄ±n. Her gÃ¼n F akoru pratiÄŸi yapÄ±n.'
            }
        };

        // Modal fonksiyonlarÄ±
        function showLessonDetail(lessonId) {
            const lesson = lessonsData[lessonId];
            if (!lesson) return;

            currentLessonId = lessonId;

            document.getElementById('modalTitle').textContent = lesson.title;
            document.getElementById('modalArtist').textContent = lesson.artist;
            document.getElementById('modalDesc').textContent = lesson.desc;
            document.getElementById('modalTips').textContent = lesson.tips;

            // Akor kartlarÄ±nÄ± oluÅŸtur
            const chordsContainer = document.getElementById('modalChords');
            chordsContainer.innerHTML = lesson.chords.map(chord => `
                <div class="chord-card">
                    <div class="chord-name">${chord.name}</div>
                    <div class="chord-fingers">${chord.fingers}</div>
                </div>
            `).join('');

            document.getElementById('lessonModal').classList.add('active');
        }

        function closeLessonModal() {
            document.getElementById('lessonModal').classList.remove('active');
        }

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');

            // Nav butonlarÄ±nÄ± gÃ¼ncelle
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.target === id) btn.classList.add('active');
            });
        }

        let currentLessonState = { active: false, step: 0, total: 0, data: null };

        function startLesson() {
            closeLessonModal();
            // VarsayÄ±lan olarak Ders 1 baÅŸlatÄ±lÄ±r
            const lessonId = currentLessonId || 1;
            const lesson = lessonsData[lessonId];

            if (!lesson || !lesson.songData) {
                alert('Bu ders iÃ§in henÃ¼z interaktif iÃ§erik hazÄ±rlanmadÄ±.\nDers 1: ArkadaÅŸÄ±m EÅŸek hazÄ±r!');
                if (lessonId !== 1) {
                    currentLessonId = 1;
                    startLesson();
                    return;
                }
                return;
            }

            // Gitar moduna geÃ§
            showSection('guitar');

            // HUD'u gÃ¶ster
            const hud = document.getElementById('lessonHud');
            hud.classList.add('active');

            // Timeline'Ä± OLUÅžTUR (Init)
            const timeline = document.getElementById('hudTimeline');
            timeline.innerHTML = '';

            // TÃ¼m notalarÄ± ekle
            lesson.songData.forEach((step, index) => {
                const el = document.createElement('div');
                el.className = 'timeline-note';
                el.textContent = step.note.split(' ')[0]; // KÄ±saltÄ±lmÄ±ÅŸ ad
                el.dataset.index = index;
                timeline.appendChild(el);
            });

            // State'i sÄ±fÄ±rla
            currentLessonState = {
                active: true,
                step: 0,
                total: lesson.songData.length,
                data: lesson.songData
            };

            // HUD Bilgilerini gÃ¼ncelle
            const artistParts = lesson.artist.split('-');
            document.getElementById('hudTitle').textContent = artistParts[0] ? artistParts[0].trim() : lesson.title;
            document.getElementById('hudArtist').textContent = artistParts[1] ? artistParts[1].trim() : '';

            updateHudStep();
        }

        function updateHudStep() {
            if (!currentLessonState.active) return;

            const stepIndex = currentLessonState.step;
            const total = currentLessonState.total;

            // BitiÅŸ KontrolÃ¼
            if (stepIndex >= total) {
                // ÅžarkÄ± Bitti! Timeline'Ä± sonuna kaydÄ±r
                updateTimelineScroll(stepIndex);

                setTimeout(() => {
                    // Basit bir konfetinin veya modalÄ±n yerini alacak alert (ÅŸimdilik)
                    alert('TEBRÄ°KLER! ÅžARKI TAMAMLANDI! ðŸŽ‰\nDoÄŸruluk: %100\nHarika bir performans!');
                    stopLesson();
                }, 300);
                return;
            }

            const step = currentLessonState.data[stepIndex];

            // SayaÃ§ ve Progress
            document.getElementById('hudCounter').textContent = `${stepIndex + 1} / ${total}`;
            const progressPct = (stepIndex / total) * 100;
            document.getElementById('hudProgress').style.width = `${progressPct}%`;

            // Ana GÃ¶sterge (HUD OrtasÄ±)
            document.getElementById('hudCurrentNote').textContent = step.note;
            document.getElementById('hudStringInfo').textContent = `Tel ${step.s}`;
            document.getElementById('hudFretInfo').textContent = `Perde ${step.f}`;
            document.getElementById('hudKeyHint').textContent = step.key;

            // Timeline GÃ¶rÃ¼nÃ¼mÃ¼ (Class GÃ¼ncelleme)
            const notes = document.querySelectorAll('.timeline-note');
            notes.forEach((el, idx) => {
                el.className = 'timeline-note'; // Reset
                if (idx < stepIndex) el.classList.add('passed');
                if (idx === stepIndex) el.classList.add('active');
            });

            // Timeline KaydÄ±rma
            updateTimelineScroll(stepIndex);
        }

        function updateTimelineScroll(index) {
            const timeline = document.getElementById('hudTimeline');
            // Her nota 40px (width) + 40px (gap) = 80px yer kaplÄ±yor.
            // BaÅŸlangÄ±Ã§ta 50% left'te duruyor, yani ilk eleman ortada.
            // Her adÄ±mda 80px sola kaymalÄ± ki bir sonraki merkeze gelsin.
            const itemWidth = 80;
            const offset = -(index * itemWidth);
            timeline.style.transform = `translateX(${offset}px)`;
        }

        function stopLesson() {
            currentLessonState.active = false;
            document.getElementById('lessonHud').classList.remove('active');
        }

        // Modal dÄ±ÅŸÄ±na tÄ±klandÄ±ÄŸÄ±nda kapat
        document.getElementById('lessonModal')?.addEventListener('click', (e) => {
            if (e.target.classList.contains('lesson-modal')) {
                closeLessonModal();
            }
        });

        // Custom dropdown functions
        function toggleGuitarDropdown() {
            const dropdown = document.getElementById('guitarDropdown');
            dropdown.classList.toggle('open');
        }

        function selectGuitarType(type, label) {
            currentGuitarType = type;
            document.getElementById('guitarTypeLabel').textContent = label;

            // Update active state
            document.querySelectorAll('.guitar-dropdown-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.type === type) {
                    item.classList.add('active');
                }
            });

            // Close dropdown
            document.getElementById('guitarDropdown').classList.remove('open');

            const config = guitarTypes[type];
            console.log('Guitar type changed to:', config.name, '- Frets:', config.frets, '- Strings:', config.strings);
            // Future: update fretboard based on guitar type
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            const dropdown = document.getElementById('guitarDropdown');
            if (dropdown && !dropdown.contains(e.target)) {
                dropdown.classList.remove('open');
            }
        });

        function getPairOffsets(pair) {
            const base = (pair - 1) * 8;
            return {
                zone1Start: base,
                zone1End: base + 3,
                zone2Start: base + 4,
                zone2End: Math.min(base + 7, maxFrets)
            };
        }

        let audioReady = false;
        async function ensureAudio() {
            if (!audioReady && typeof audioEngine !== 'undefined') {
                await audioEngine.init();
                audioReady = true;
            }
        }

        function setPair(pair) {
            currentPair = pair;
            document.querySelectorAll('.pair-card').forEach(c => c.classList.toggle('active', parseInt(c.dataset.pair) === pair));
            buildZoneGrids();
            updateZoneTags();
        }

        function updateZoneTags() {
            const off = getPairOffsets(currentPair);
            const z1 = (currentPair - 1) * 2 + 1;
            const z2 = (currentPair - 1) * 2 + 2;
            document.getElementById('zone1Tag').textContent = `Zone ${z1} (${off.zone1Start}-${off.zone1End})`;
            document.getElementById('zone2Tag').textContent = `Zone ${z2} (${off.zone2Start}-${off.zone2End})`;
        }

        // ===== FRETBOARD =====
        function buildFretboard() {
            const fretboardEl = document.getElementById('fretboard');
            const labelsEl = document.getElementById('stringLabels');
            const endF = Math.min(fretStart + visibleFrets - 1, maxFrets);

            // Build string labels separately
            let labelsHtml = '';
            for (let s = 6; s >= 1; s--) {
                labelsHtml += `<div class="string-label" data-s="${s}" onclick="playOpenString(${s})">${stringLabels[6 - s]}</div>`;
            }
            labelsEl.innerHTML = labelsHtml;

            // Build fretboard
            let h = '<div class="frets-row">';
            for (let f = fretStart; f <= endF; f++) {
                const hasInlay = inlays.includes(f);
                const isDouble = doubleInlay.includes(f);

                h += `<div class="fret-col" data-f="${f}">`;
                if (hasInlay) {
                    if (isDouble) {
                        h += '<div class="inlay double1"></div><div class="inlay double2"></div>';
                    } else {
                        h += '<div class="inlay single"></div>';
                    }
                }

                for (let s = 6; s >= 1; s--) {
                    h += `<div class="string-cell" data-s="${s}" data-f="${f}" onclick="playFretCell(this)"><div class="note-dot"></div></div>`;
                }
                // Only show fret number for inlay frets
                const showNum = hasInlay ? 'show' : '';
                const hlClass = f === 12 ? 'hl' : '';
                h += `<div class="fret-num ${showNum} ${hlClass}">${f}</div></div>`;
            }
            h += '</div>';
            fretboardEl.innerHTML = h;
            document.getElementById('fretRange').textContent = `Perde ${fretStart}-${endF}`;
        }

        async function playOpenString(s) {
            await ensureAudio();
            playNote(s, 0, null);
            const label = document.querySelector(`.string-label[data-s="${s}"]`);
            if (label) {
                label.classList.add('active');
                setTimeout(() => label.classList.remove('active'), 400);
            }
        }

        async function playFretCell(cell) {
            await ensureAudio();
            playNote(parseInt(cell.dataset.s), parseInt(cell.dataset.f), cell);
        }

        function shiftFrets(dir) {
            fretStart = Math.max(1, Math.min(fretStart + dir * 4, maxFrets - visibleFrets + 1));
            buildFretboard();
        }

        // ===== ZONE GRIDS =====
        function buildZoneGrids() {
            const off = getPairOffsets(currentPair);
            buildZoneGrid('zone1Grid', off.zone1Start, off.zone1End, oddZoneKeys);
            buildZoneGrid('zone2Grid', off.zone2Start, off.zone2End, evenZoneKeys);
        }

        function buildZoneGrid(id, startF, endF, keys) {
            const c = document.getElementById(id);
            let h = '<div class="grid-label"></div>';
            ['e1', 'B', 'G', 'D', 'A', 'E6'].forEach(l => h += `<div class="grid-header">${l}</div>`);

            for (let i = 0; i <= endF - startF; i++) {
                const fret = startF + i;
                const label = fret === 0 ? 'AÃ§Ä±k Tel:' : `Perde ${fret}:`;

                h += `<div class="grid-label">${label}</div>`;
                for (let s = 1; s <= 6; s++) {
                    const key = keys[i] ? keys[i][s - 1] : '';
                    // Use toLocaleLowerCase for proper Turkish handling
                    const keyLower = key.toLocaleLowerCase('tr-TR');
                    // Special attribute for double quote
                    const quoteAttr = key === '"' ? ' data-quote="true"' : '';
                    h += `<button class="key-btn s${s}" data-s="${s}" data-f="${fret}" data-key="${keyLower}" data-key-upper="${key}"${quoteAttr} onclick="playKeyBtn(this)">${key}</button>`;
                }
            }
            c.innerHTML = h;
        }

        async function playKeyBtn(btn) {
            await ensureAudio();
            btn.classList.add('active');
            setTimeout(() => btn.classList.remove('active'), 300);
            playNote(parseInt(btn.dataset.s), parseInt(btn.dataset.f), null);

            // Ders Aktivite KontrolÃ¼
            if (currentLessonState && currentLessonState.active) {
                const currentStep = currentLessonState.data[currentLessonState.step];
                if (!currentStep) return; // Liste bitti veya hata

                const playedString = parseInt(btn.dataset.s);
                const playedFret = parseInt(btn.dataset.f);

                if (playedString === currentStep.s && playedFret === currentStep.f) {
                    currentLessonState.step++;
                    updateHudStep();
                }
            }
        }

        function playNote(stringNum, fret, elem) {
            const note = getNote(stringNum, fret);

            if (typeof audioEngine !== 'undefined') audioEngine.playGuitarString(stringNum, fret);

            document.querySelectorAll('.string-cell.active, .string-label.active').forEach(e => e.classList.remove('active'));
            document.querySelectorAll('.string-cell.vibrating').forEach(e => e.classList.remove('vibrating'));

            // Vibrate
            document.querySelectorAll(`.string-cell[data-s="${stringNum}"]`).forEach(cell => {
                cell.classList.add('vibrating');
                setTimeout(() => cell.classList.remove('vibrating'), 400);
            });

            // Open string highlight
            if (fret === 0) {
                const label = document.querySelector(`.string-label[data-s="${stringNum}"]`);
                if (label) {
                    label.classList.add('active');
                    setTimeout(() => label.classList.remove('active'), 400);
                }
            }

            // Show on fretboard
            const fretCell = document.querySelector(`.string-cell[data-s="${stringNum}"][data-f="${fret}"]`);
            if (fretCell) {
                const dot = fretCell.querySelector('.note-dot');
                if (dot) dot.textContent = note;
                fretCell.classList.add('active');
                setTimeout(() => fretCell.classList.remove('active'), 400);
            }

            updateNoteDisplay(note, stringNum, fret);
        }

        function getNote(s, f) {
            const open = tuning[s - 1];
            return typeof NoteMapping !== 'undefined' ? NoteMapping.transpose(open, f) : open;
        }

        function updateNoteDisplay(note, s, f) {
            let turkish = note, freq = 0;
            if (typeof NoteMapping !== 'undefined') {
                turkish = NoteMapping.getTurkishName(note);
                freq = NoteMapping.getFrequency(note);
            }
            document.getElementById('noteDisplay').textContent = `${turkish} (${note}) - ${freq.toFixed(1)} Hz`;
            document.getElementById('posDisplay').textContent = `Tel ${s}, Perde ${f}`;
        }

        function stopAll() { if (typeof audioEngine !== 'undefined') audioEngine.stopAll(); }

        function showHelp() {
            alert('Klavye KÄ±sayollarÄ±:\n\nZone 1,3,5: 1-6, Q-Y, A-H, <-B\nZone 2,4,6: 7 8 9 0 * -, U-Ãœ, J-;, N-"\n\n[ / ]: Pair DeÄŸiÅŸtir\nSPACE: Mute');
        }

        // Keyboard - Turkish character aware
        document.addEventListener('keydown', async e => {
            if (currentMode !== 'guitar') return;
            await ensureAudio();

            if (e.key === ' ') { e.preventDefault(); stopAll(); return; }

            // Pair navigation: [ ] or Numpad +/-
            if (e.key === ']' || e.key === '+' || e.code === 'NumpadAdd') {
                setPair(Math.min(3, currentPair + 1));
                return;
            }
            if (e.key === '[' || e.code === 'NumpadSubtract') {
                setPair(Math.max(1, currentPair - 1));
                return;
            }

            // Handle Turkish characters properly
            let pressedKey = e.key;
            let searchKey = pressedKey.toLocaleLowerCase('tr-TR');

            // Try to find button with the pressed key
            let btn = null;

            // Special handling for " (double quote) - use data-quote attribute
            if (pressedKey === '"') {
                btn = document.querySelector('.key-btn[data-quote="true"]');
            } else {
                btn = document.querySelector(`.key-btn[data-key="${searchKey}"]`);
            }

            // Try exact match for special characters
            if (!btn && (pressedKey === '-' || pressedKey === '*' || pressedKey === '.')) {
                btn = document.querySelector(`.key-btn[data-key="${pressedKey}"]`);
            }

            // If not found and it's a Turkish character, try uppercase match
            if (!btn) {
                const upperKey = turkishKeyMap[pressedKey] || pressedKey.toLocaleUpperCase('tr-TR');
                btn = document.querySelector(`.key-btn[data-key-upper="${upperKey}"]`);
            }

            if (btn) playKeyBtn(btn);
        });

        // Piano
        const pianoKeysList = [
            { n: 'C4', b: false, k: 'a' }, { n: 'C#4', b: true, k: 'w' }, { n: 'D4', b: false, k: 's' },
            { n: 'D#4', b: true, k: 'e' }, { n: 'E4', b: false, k: 'd' }, { n: 'F4', b: false, k: 'f' },
            { n: 'F#4', b: true, k: 't' }, { n: 'G4', b: false, k: 'g' }, { n: 'G#4', b: true, k: 'y' },
            { n: 'A4', b: false, k: 'h' }, { n: 'A#4', b: true, k: 'u' }, { n: 'B4', b: false, k: 'j' }, { n: 'C5', b: false, k: 'k' }
        ];

        function buildPiano() {
            let h = '';
            pianoKeysList.forEach(pk => {
                const cls = pk.b ? 'black-key' : 'white-key';
                h += `<div class="${cls}" data-note="${pk.n}" data-pkey="${pk.k}" onclick="playPianoKey(this)">${pk.k.toUpperCase()}</div>`;
            });
            document.getElementById('pianoKeys').innerHTML = h;
        }

        async function playPianoKey(el) {
            await ensureAudio();
            if (typeof audioEngine !== 'undefined') audioEngine.playNoteName(el.dataset.note, 2, 'piano');
            el.classList.add('active');
            setTimeout(() => el.classList.remove('active'), 200);
        }

        document.addEventListener('keydown', async e => {
            if (currentMode !== 'piano') return;
            await ensureAudio();
            const pk = pianoKeysList.find(p => p.k === e.key.toLowerCase());
            if (pk) {
                const el = document.querySelector(`[data-pkey="${pk.k}"]`);
                if (el) playPianoKey(el);
            }
        });

        // Lessons
        function buildLessons() {
            const lessons = [
                { icon: 'ðŸŽµ', title: 'Ders 1: Nota Bilgisi', artist: 'ArkadaÅŸÄ±m EÅŸek' },
                { icon: 'ðŸŽ¸', title: 'Ders 2: Ä°lk AkorlarÄ±m', artist: 'Hayat Bayram Olsa' },
                { icon: 'âœ‹', title: 'Ders 3: Teknik', artist: 'Palm Mute' }
            ];
            let h = '';
            lessons.forEach(l => {
                h += `<div class="lesson-card"><div class="lesson-icon">${l.icon}</div><div class="lesson-title">${l.title}</div><div class="lesson-artist">${l.artist}</div><div class="lesson-btns"><button class="lesson-btn primary">â–¶ BaÅŸlat</button><button class="lesson-btn secondary">ðŸ“„ Detay</button></div></div>`;
            });
            document.getElementById('lessonsGrid').innerHTML = h;
        }

        function showSection(id) {
            currentMode = id;
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach((b, i) => b.classList.toggle('active', ['guitar', 'piano', 'lessons'][i] === id));
        }

        // ============================================
        // EFFECTS PANEL CONTROLS
        // ============================================

        function toggleEffectsPanel() {
            const panel = document.getElementById('effectsPanel');
            panel.classList.toggle('active');
        }

        // Amp Presets
        function setAmpPreset(preset) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setAmpPreset(preset);
            }

            // Update UI
            document.querySelectorAll('.amp-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.preset === preset);
            });

            // Update EQ sliders to match preset
            const presets = {
                clean: { low: 2, mid: 0, high: 3 },
                crunch: { low: 4, mid: 2, high: 4 },
                highgain: { low: 6, mid: -2, high: 5 },
                acoustic: { low: -2, mid: 3, high: 5 },
                jazz: { low: 3, mid: -1, high: -2 },
                metal: { low: 8, mid: -4, high: 6 }
            };

            const p = presets[preset];
            if (p) {
                document.getElementById('eqLow').value = p.low;
                document.getElementById('eqMid').value = p.mid;
                document.getElementById('eqHigh').value = p.high;
                document.getElementById('eqLowValue').textContent = p.low + ' dB';
                document.getElementById('eqMidValue').textContent = p.mid + ' dB';
                document.getElementById('eqHighValue').textContent = p.high + ' dB';
            }
        }

        // Volume
        function updateVolume(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setVolume(value);
            }
            document.getElementById('volumeValue').textContent = value + '%';
        }

        // Reverb
        function updateReverb(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setReverbMix(value / 100);
            }
            document.getElementById('reverbValue').textContent = value + '%';
        }

        // Chorus
        let chorusEnabled = false;
        function toggleChorus() {
            chorusEnabled = !chorusEnabled;
            document.getElementById('chorusToggle').classList.toggle('active', chorusEnabled);
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setChorusEnabled(chorusEnabled);
            }
        }

        function updateChorusRate(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setChorusRate(parseFloat(value));
            }
            document.getElementById('chorusRateValue').textContent = value + ' Hz';
        }

        function updateChorusDepth(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setChorusDepth(value / 10000); // Scale down for subtle effect
            }
            document.getElementById('chorusDepthValue').textContent = value + '%';
        }

        function updateChorusMix(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setChorusMix(value / 100);
            }
            document.getElementById('chorusMixValue').textContent = value + '%';
        }

        // Delay
        let delayEnabled = false;
        function toggleDelay() {
            delayEnabled = !delayEnabled;
            document.getElementById('delayToggle').classList.toggle('active', delayEnabled);
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setDelayEnabled(delayEnabled);
            }
        }

        function updateDelayTime(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setDelayTime(value / 1000); // Convert to seconds
            }
            document.getElementById('delayTimeValue').textContent = value + ' ms';
        }

        function updateDelayFeedback(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setDelayFeedback(value / 100);
            }
            document.getElementById('delayFeedbackValue').textContent = value + '%';
        }

        function updateDelayMix(value) {
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setDelayMix(value / 100);
            }
            document.getElementById('delayMixValue').textContent = value + '%';
        }

        // EQ
        function updateEQ() {
            const low = parseInt(document.getElementById('eqLow').value);
            const mid = parseInt(document.getElementById('eqMid').value);
            const high = parseInt(document.getElementById('eqHigh').value);

            if (typeof audioEngine !== 'undefined') {
                audioEngine.setEQ(low, mid, high);
            }

            document.getElementById('eqLowValue').textContent = low + ' dB';
            document.getElementById('eqMidValue').textContent = mid + ' dB';
            document.getElementById('eqHighValue').textContent = high + ' dB';
        }

        // Metronome
        let metronomeRunning = false;
        function toggleMetronome() {
            metronomeRunning = !metronomeRunning;
            const btn = document.getElementById('metronomeBtn');

            if (metronomeRunning) {
                const bpm = parseInt(document.getElementById('bpmSlider').value);
                if (typeof audioEngine !== 'undefined') {
                    audioEngine.startMetronome(bpm);
                }
                btn.textContent = 'â¸';
                btn.classList.add('playing');
            } else {
                if (typeof audioEngine !== 'undefined') {
                    audioEngine.stopMetronome();
                }
                btn.textContent = 'â–¶';
                btn.classList.remove('playing');
            }
        }

        function updateBPM(value) {
            document.getElementById('bpmValue').textContent = value;
            if (typeof audioEngine !== 'undefined') {
                audioEngine.setMetronomeBPM(parseInt(value));
            }
        }

        // Click outside to close effects panel
        document.addEventListener('click', (e) => {
            const panel = document.getElementById('effectsPanel');
            const btn = e.target.closest('.icon-btn');
            if (panel.classList.contains('active') &&
                !panel.contains(e.target) &&
                !btn) {
                panel.classList.remove('active');
            }
        });

        // INIT
        buildFretboard();
        buildZoneGrids();
        updateZoneTags();
        buildPiano();
        buildLessons();
    </script>
</body>

</html>